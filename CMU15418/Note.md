# Lec 2 
在2004年前后, 人们发现 **登纳德缩放定律(Dennard Scaling)** 逐渐失效, 单位面积的晶体管数量增加导致热量功率飙升, 导致CPU主频无法继续提升, **单核性能达到瓶颈**.
> 登纳德缩放定律由 Robert Dennard 于 1974 年提出，指出：当晶体管尺寸按比例缩小（如缩小为原来的 1/S），若同时将电压和掺杂浓度等参数同比例缩放，则：
> - 晶体管开关速度提升（延迟降低）  
> - 单位面积功耗保持不变  
> - 芯片性能提升而不会过热
> 这一定律曾与摩尔定律共同推动芯片性能持续增长。但约在 **2004 年后失效**，主要因电压无法继续降低，导致漏电和功耗密度急剧上升，形成**“功耗墙”（Power Wall）**

人们因此转向多核时代, 但这也意味着软件设计迈向 **并行计算化**

### ILP (指令层并行, Instruction-Level Parallelism)

ILP 是指程序中 **多条指令可以同时(或重叠)执行的潜力** . 即使代码是按顺序写的, 只要某些指令之间没有**数据依赖, 控制依赖或资源冲突**, 它们就可以并行处理
e.g.
```Asm
ADD R1, R2, R3   ; R1 = R2 + R3
MUL R4, R5, R6   ; R4 = R5 * R6
SUB R7, R8, R9   ; R7 = R8 - R9
```

### OoOE (乱序执行, Out-of-Order Execution)
OoOE（Out-of-Order Execution，乱序执行）是一种现代处理器中用于提升指令执行效率的优化技术。

#### 基本原理

在传统的**顺序执行**（in-order execution）模型中，处理器严格按照程序中指令的顺序依次执行。然而，当某条指令因等待数据（如从内存加载）而阻塞时，后续本可独立执行的指令也会被迫等待，造成性能浪费。

OoOE 允许处理器**动态重排指令的执行顺序**，只要不违反数据依赖关系（data dependencies），就可以提前执行那些操作数已就绪的指令，从而提高 CPU 的利用率和整体吞吐量。

#### 主要步骤

1. **取指**（Fetch）：从内存中获取指令。
2. **译码**（Decode）：将指令分解为微操作（μops）。
3. **重命名**（Rename）：使用寄存器重命名消除假性依赖（如 WAW、WAR）。
4. **分发**（Dispatch）：将微操作放入保留站（Reservation Station）。
5. **调度与执行**（Schedule & Execute）：当操作数就绪时，乱序执行。
6. **提交**（Commit/Retire）：按原始程序顺序提交结果，确保语义正确。

#### 优点

- 提高指令级并行度（ILP, Instruction-Level Parallelism）
- 减少流水线停顿（pipeline stalls）
- 更好地隐藏内存延迟

#### 缺点

- 硬件复杂度显著增加
- 功耗和面积开销较大
- 调试和性能分析更困难